CREATE TABLE SCH_KIOSCO.PRODUCT_CATEGORY(
CATEGORY_ID BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
IS_ACTIVE BIT,
CATEGORY_NAME VARCHAR(255) NOT NULL,
PHOTO VARCHAR(255),
POSITION_ INTEGER NOT NULL,
POSITIONINCASH INTEGER NOT NULL,
PARENT_ID BIGINT,
VAT_ID BIGINT,
UNIQUE(CATEGORY_NAME),
FOREIGN KEY(PARENT_ID) REFERENCES SCH_KIOSCO.PRODUCT_CATEGORY(CATEGORY_ID)
);

CREATE TABLE SCH_KIOSCO.RUBRO(
RUBRO_ID BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
IS_ACTIVE BIT,
RUBRO_NAME VARCHAR(255) NOT NULL,
FECHA_ALTA DATETIME,
FECHA_BAJA DATETIME,
UNIQUE(RUBRO_NAME)
);

CREATE TABLE SCH_KIOSCO.MARCA(
MARCA_ID BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
IS_ACTIVE BIT,
MARCA_NAME VARCHAR(255) NOT NULL,
FECHA_ALTA DATETIME,
FECHA_BAJA DATETIME,
UNIQUE(MARCA_NAME)
);

CREATE TABLE SCH_KIOSCO.PRODUCT(
PRODUCT_ID BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
MARCA_ID BIGINT,
CATEGORY_ID BIGINT NOT NULL,
IS_TEMPORAL BIT,
FECHA_ALTA DATETIME,
FECHA_BAJA DATETIME,
CODIGO_BARRAS VARCHAR(255),
FECHA_ACTUALIZACION DATETIME,
RUBRO_ID BIGINT,
NOMBRE VARCHAR(255),
FOREIGN KEY(MARCA_ID) REFERENCES SCH_KIOSCO.MARCA(MARCA_ID),
FOREIGN KEY(RUBRO_ID) REFERENCES SCH_KIOSCO.RUBRO(RUBRO_ID),
FOREIGN KEY(CATEGORY_ID) REFERENCES SCH_KIOSCO.PRODUCT_CATEGORY(CATEGORY_ID)
);

CREATE TABLE SCH_KIOSCO.PRICE(
PRICE_ID BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
PRODUCT_ID BIGINT NOT NULL,
IS_ACTIVE BIT,
VALOR DOUBLE NOT NULL,
FECHA_ACTUALIZACION DATETIME,
FOREIGN KEY(PRODUCT_ID) REFERENCES SCH_KIOSCO.PRODUCT(PRODUCT_ID)
);

CREATE TABLE SCH_KIOSCO.VENTA(
VENTA_ID BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
FECHA_VENTA DATETIME,
CANTIDAD BIGINT,
TOTAL DOUBLE
);

CREATE TABLE SCH_KIOSCO.LINEA_DE_VENTA(
LINEA_ID BIGINT NOT NULL AUTO_INCREMENT,
VENTA_ID BIGINT NOT NULL,
PRODUCT_ID BIGINT NOT NULL,
SUBTOTAL DOUBLE,
FECHA_LINEA_VENTA DATETIME,
IS_FACTURABLE BIT,
PRIMARY KEY (LINEA_ID,VENTA_ID,PRODUCT_ID),
FOREIGN KEY(VENTA_ID) REFERENCES SCH_KIOSCO.VENTA(VENTA_ID),
FOREIGN KEY(PRODUCT_ID) REFERENCES SCH_KIOSCO.PRODUCT(PRODUCT_ID)
);

CREATE TABLE SCH_KIOSCO.FACTURA(
FACTURA_ID BIGINT NOT NULL,
LINEA_ID BIGINT NOT NULL,
SUBTOTAL DOUBLE,
TOTAL DOUBLE,
FECHA_FACTURA DATETIME,
CLIENTE VARCHAR(255),
EMPRESA VARCHAR(255),
PRIMARY KEY(FACTURA_ID,LINEA_ID),
FOREIGN KEY(LINEA_ID) REFERENCES SCH_KIOSCO.LINEA_DE_VENTA(LINEA_ID)
);

CREATE TABLE SCH_KIOSCO.USUARIO(
USUARIO_ID BIGINT PRIMARY KEY NOT NULL AUTO_INCREMENT,
USER_NAME VARCHAR(255),
PASS VARCHAR(255),
FECHA_ACTUALIZACION DATETIME,
PASS_ANT VARCHAR(255),
IS_ACTIVO BIT,
UNIQUE(USER_NAME)
);

CREATE TABLE SCH_KIOSCO.STOCK(
STOCK_ID BIGINT PRIMARY KEY NOT NULL AUTO_INCREMENT,
PRODUCT_ID BIGINT,
FECHA_REPO DATETIME,
USUARIO_ID BIGINT,
STOCK_MINIMO BIGINT,
STOCK_ACTUAL BIGINT,
FOREIGN KEY(PRODUCT_ID) REFERENCES SCH_KIOSCO.PRODUCT(PRODUCT_ID),
FOREIGN KEY(USUARIO_ID) REFERENCES SCH_KIOSCO.USUARIO(USUARIO_ID)
);

CREATE TABLE SCH_KIOSCO.CAJA_PARCIAL(
CAJA_PARCIAL_ID BIGINT NOT NULL AUTO_INCREMENT,
ENTRADA_ID BIGINT NOT NULL,
SALIDA_ID BIGINT NOT NULL,
FECHA_CIERRE_PARCIAL DATETIME,
CANTIDAD BIGINT,
TOTAL DOUBLE,
SUBCANTIDAD BIGINT,
SUBTOTAL DOUBLE,
PRIMARY KEY(CAJA_PARCIAL_ID,ENTRADA_ID,SALIDA_ID),
FOREIGN KEY(ENTRADA_ID) REFERENCES SCH_KIOSCO.STOCK(STOCK_ID),
FOREIGN KEY(SALIDA_ID) REFERENCES SCH_KIOSCO.VENTA(VENTA_ID)
);

CREATE TABLE SCH_KIOSCO.CAJA(
CAJA_ID BIGINT NOT NULL AUTO_INCREMENT,
CAJA_PARCIAL_ID BIGINT NOT NULL,
FECHA_CIERRE DATETIME,
HORA_INICIO TIMESTAMP,
HORA_FIN TIMESTAMP,
CANTIDAD BIGINT,
TOTAL DOUBLE,
SUBCANTIDAD BIGINT,
SUBTOTAL DOUBLE,
PRIMARY KEY(CAJA_ID,CAJA_PARCIAL_ID),
FOREIGN KEY(CAJA_PARCIAL_ID) REFERENCES SCH_KIOSCO.CAJA_PARCIAL(CAJA_PARCIAL_ID)
);
